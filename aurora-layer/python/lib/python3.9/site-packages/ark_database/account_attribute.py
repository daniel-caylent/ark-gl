import db_main
import connection

def get_all(db:str) -> tuple:
    query = """
        SELECT accatt.id as attributeNo, acctyp.name as accountType, accatt.detail_type as detailType
        FROM """+db+""".account_attribute accatt
        INNER JOIN """+db+""".account_type acctyp ON (accatt.account_type_id = acctyp.id);"""

    return (query,)

def get_query_select_by_uuid(db:str, uuid:str) -> tuple:
    query = "SELECT * FROM "+db+".account_attribute where uuid = %s;"

    params = (uuid,)

    return (query, params)

def select_by_uuid(db:str, uuid:str, region_name:str, secret_name:str, db_type:str = 'ro') -> dict:
    params = get_query_select_by_uuid(db, uuid)

    conn = connection.get_connection(db, region_name, secret_name, db_type)

    record = db_main.execute_single_record_select(conn, params)

    return record

def get_id(db:str, uuid:str, region_name:str, secret_name:str, db_type:str = 'ro') -> str:
    record = select_by_uuid(db, uuid, region_name, secret_name, db_type)

    return record.get('id')
