import db_main
import connection

# app_to_db = {
#     'fundId': 'uuid',
#     'clientId': 'client_id',
#     # '': 'fund_id'
# }

def get_query_select_by_uuid(db:str, uuid:str) -> tuple:
    query = "SELECT * FROM "+db+".fund_entity where uuid = %s;"

    params = (uuid,)

    return (query, params)

def select_by_uuid(db:str, uuid:str, region_name:str, secret_name:str, db_type:str = 'ro') -> dict:
    params = get_query_select_by_uuid(db, uuid)

    conn = connection.get_connection(db, region_name, secret_name, db_type)

    record = db_main.execute_single_record_select(conn, params)

    return record

def get_id(db:str, uuid:str, region_name:str, secret_name:str, db_type:str = 'ro') -> str:
    record = select_by_uuid(db, uuid, region_name, secret_name, db_type)

    return record.get('id')
