app_to_db = {
    'accountNo': 'uuid',
    'parentAccountNo': 'parent_id',
    'accountName': 'name',
    'accountDescription': 'description',
    'attributeNo': 'account_attribute_id',
    'isHidden': 'is_hidden',
    'isTaxable': 'is_taxable',
    'isVendorCustomerPartnerRequired': 'is_vendor_customer_partner_required',
    'FSMappingId': 'fs_mapping_id',
    'FSName': 'fs_name',
    'isDryRun': 'is_dry_run'
}

db_to_app = {v: k for k, v in app_to_db.items()}

def translate_to_db(input:dict) -> dict:
    return dict((app_to_db[key], value) for (key, value) in input.items())

def translate_to_app(input:dict) -> dict:
    return dict((db_to_app[key], value) for (key, value) in input.items())

def insert(db:str, input:dict) -> tuple:
    query = """
        INSERT INTO """+db+""".account
            (uuid, fund_entity_id, account_attribute_id, parent_id, name, description,
            state, is_hidden, is_taxable, is_vendor_customer_partner_required)
        VALUES
            (%s, %s, %s, %s, %s, %s,
            %s, %s, %s, %s);"""
    
    translated_input = translate_to_db(input)

    params = (
        translated_input['uuid'],
        translated_input['fund_entity_id'],
        translated_input['account_attribute_id'],
        translated_input['parent_id'],
        translated_input['name'],
        translated_input['description'],
        translated_input['state'],
        translated_input['is_hidden'],
        translated_input['is_taxable'],
        translated_input['is_vendor_customer_partner_required']
    )

    return (query, params)

def update(db:str, id:str, input:dict) -> tuple:
    update_query = """
        UPDATE """+db+""".account
        SET """
    where_clause = "WHERE uuid = %s;"
    
    translated_input = translate_to_db(input)

    set_clause = ''
    params = ()
    for key in translated_input.keys():
        set_clause += str(key)+" = %s\n"
        params += (translated_input[key],)
    
    params += (id,)

    query = update_query+set_clause+where_clause

    return (query, params)
